<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>pieChartExam</title>
</head>
<body>
<div class="graph"></div>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script type="text/javascript">
  var w = 300, h = 300;
  var svg = d3.select(".graph")
    .append("svg")
    .attr("width", w)
    .attr("height", h)
    .attr("id", "graphWrap");

  var graphWrap = d3.select("#graphWrap");

  var graphData = [50, 30, 12, 5, 3]; // 원형데이터의 경우 x축과 y축이 없기 때문에 단순배열로 설정한다.
  var pie = d3.pie();
  var arc = d3.arc().innerRadius(40).outerRadius(150); // 안쪽지름 0, 반지름 100
  var colors = d3.scaleOrdinal(d3.schemeCategory10);

  var g = svg.selectAll(".pie")
    .data(pie(graphData))
    .enter()
    .append("g")
    .attr("class", "pie")
    .attr("transform", "translate(" + (w/2)+ "," + (h/2) + ")");

  g.append("path")
  .style("fill", function(d, i) {
    return colors(graphData[i]);})
  // .attr('d', d3.arc()
  //   .innerRadius(0) // 안쪽지름
  //   .outerRadius(100)) // 반지름
  .transition()
  .duration(500)
  .attrTween("d", function(d, i){
    var interpolate = d3.interpolate(
      {startAngle : d.startAngle, endAngle : d.startAngle},
      {startAngle : d.startAngle, endAngle : d.endAngle}
    );
    return function(t){
      return arc(interpolate(t));
    }
  });

  // 텍스트 추가
  g.append("text")
    .attr("transform", function(d){return "translate(" + arc.centroid(d) +")";})
    .attr("dy", ".35em")
    .style("text-anchor","middle")
    .text(function(d, i){
      return graphData[i];
    });

  svg.append("text")
    .attr("class", "total")
    .attr("transform", "translate(" +(w/2-15)+","+(h/2+5)+")")
    .text(d3.sum(graphData));
</script>
</body>
</html>
